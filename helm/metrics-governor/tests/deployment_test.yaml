suite: Deployment template
templates:
  - templates/deployment.yaml
tests:
  - it: renders a Deployment by default
    asserts:
      - isKind:
          of: Deployment
      - equal:
          path: metadata.name
          value: RELEASE-NAME-metrics-governor

  - it: sets replicas from replicaCount
    set:
      replicaCount: 3
    asserts:
      - equal:
          path: spec.replicas
          value: 3

  - it: omits replicas when autoscaling is enabled
    set:
      autoscaling.enabled: true
    asserts:
      - isNull:
          path: spec.replicas

  - it: sets strategy from deployment.strategy
    set:
      deployment.strategy.type: Recreate
    asserts:
      - equal:
          path: spec.strategy.type
          value: Recreate

  - it: does not render when kind is statefulset
    set:
      kind: statefulset
    asserts:
      - hasDocuments:
          count: 0
