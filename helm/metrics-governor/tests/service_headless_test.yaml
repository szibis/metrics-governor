suite: Headless Service template
templates:
  - templates/service-headless.yaml
tests:
  - it: renders when kind is statefulset
    set:
      kind: statefulset
    asserts:
      - isKind:
          of: Service
      - equal:
          path: metadata.name
          value: RELEASE-NAME-metrics-governor-headless

  - it: has clusterIP None
    set:
      kind: statefulset
    asserts:
      - equal:
          path: spec.clusterIP
          value: None

  - it: has publishNotReadyAddresses true
    set:
      kind: statefulset
    asserts:
      - equal:
          path: spec.publishNotReadyAddresses
          value: true

  - it: does not render when kind is deployment
    asserts:
      - hasDocuments:
          count: 0
