# Production configuration example
# Recommended settings for production deployments

receiver:
  grpc:
    address: ":4317"
  http:
    address: ":4318"
    server:
      max_request_body_size: 10485760  # 10MB limit
      read_header_timeout: 30s
      write_timeout: 1m
      idle_timeout: 2m
  tls:
    enabled: true
    cert_file: "/etc/tls/receiver/tls.crt"
    key_file: "/etc/tls/receiver/tls.key"

exporter:
  endpoint: "otel-collector.monitoring:4317"
  protocol: "grpc"
  insecure: false
  timeout: 60s
  tls:
    enabled: true
    ca_file: "/etc/tls/ca.crt"

buffer:
  size: 50000
  batch_size: 2000
  flush_interval: 10s

stats:
  address: ":9090"
  labels:
    - service
    - env
    - cluster

limits:
  dry_run: false

# Performance tuning for production workloads
# Techniques inspired by VictoriaMetrics blog articles (https://valyala.medium.com/)
performance:
  export_concurrency: 64               # higher limit for production throughput
  string_interning: true               # reduces allocations by ~76%
  intern_max_value_length: 64          # intern common label values

# Rule cache configuration
# The rule cache is an LRU cache that maps metric names to their matching
# limit rules. This avoids re-evaluating regex patterns on every datapoint.
# For production, size this based on the number of unique metric names.
# rule_cache_max_size: 10000           # default; increase for high-cardinality workloads
